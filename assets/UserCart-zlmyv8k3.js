import{S as _,a as S}from"./sweetalert2.all-7tlv3fUz.js";import{_ as k,f as b,m as g,r as h,o as i,c as d,a as e,F as p,g as v,i as E,t as m,b as n,w as x,e as M,n as f,k as U,v as I}from"./index-nSxjhW7Q.js";import{c as y}from"./cartStore-S0JMqBU2.js";import{s as V}from"./sweetMessageStore-ZCkrV0Jk.js";var T={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"ming777",BASE_URL:"/2023-vue-week06/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:q,VITE_PATH:A}=T,D={data(){return{form:{user:{email:"",name:"",tel:"",address:""},message:""}}},methods:{...b(y,["getCart","changeQty","removeCartAllItem","removeCartItem"]),...b(V,["setSweetMessageSuccess","setSweetMessageError"]),createOrder(){if(this.carts.carts.length===0)this.setSweetMessageError("購物車是空的 無法送出訂單"),_.fire(this.sweetMessage);else{const a=this.form;S.post(`${q}/api/${A}/order`,{data:a}).then(s=>{this.setSweetMessageSuccess(s.data.message),this.$refs.form.resetForm(),this.form.message="",this.getCart(),_.fire(this.sweetMessage)}).catch(s=>{this.setSweetMessageError(s.response.data.message),_.fire(this.sweetMessage)})}}},mounted(){this.getCart()},computed:{...g(y,["carts","cartCount"]),...g(V,["sweetMessage"])}},R={class:"text-end"},B=["disabled"],L={key:0,class:"text-center"},N={key:1,class:"table align-middle"},O=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),F=["onClick"],P=e("i",{class:"fas fa-spinner fa-pulse"},null,-1),H={class:"input-group input-group-sm"},Q={class:"input-group mb-3"},j=["value","onChange"],z=["value"],G={class:"input-group-text",id:"basic-addon2"},J={class:"text-end"},K=e("td",{colspan:"3",class:"text-end"},"總計",-1),W={class:"text-end"},X={class:"my-5 row justify-content-center"},Y={class:"mb-3"},Z=e("label",{for:"email",class:"form-label"},"Email",-1),$={class:"mb-3"},ee=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),se={class:"mb-3"},te=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),ae={class:"mb-3"},oe=e("label",{for:"address",class:"form-label"},"收件人地址",-1),le={class:"mb-3"},ne=e("label",{for:"message",class:"form-label"},"留言",-1),re={class:"text-end"},ie=["disabled"];function de(a,s,me,ce,l,C){const c=h("v-field"),u=h("error-message"),w=h("v-form");return i(),d(p,null,[e("div",R,[e("button",{class:"btn btn-outline-danger",type:"button",disabled:a.cartCount===0,onClick:s[0]||(s[0]=t=>a.removeCartAllItem())}," 清空購物車 ",8,B)]),a.cartCount===0?(i(),d("h2",L,"目前購物車是空的")):(i(),d("table",N,[O,e("tbody",null,[a.carts.carts?(i(!0),d(p,{key:0},v(a.carts.carts,(t,o)=>(i(),d("tr",{key:o},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:r=>a.removeCartItem(t.id)},[P,M(" x ")],8,F)]),e("td",null,m(t.product.title),1),e("td",null,[e("div",H,[e("div",Q,[e("select",{class:"form-select",name:"qty",id:"qty",value:t.qty,onChange:r=>a.changeQty(t.id,t.product_id,r)},[(i(),d(p,null,v(20,r=>e("option",{value:r,key:r},m(r),9,z)),64))],40,j),e("span",G,m(t.product.unit),1)])])]),e("td",J,m(t.total),1)]))),128)):E("",!0)]),e("tfoot",null,[e("tr",null,[K,e("td",W,m(a.carts.final_total),1)])])])),e("div",X,[n(w,{ref:"form",class:"col-md-6",onSubmit:C.createOrder},{default:x(({errors:t})=>[e("div",Y,[Z,n(c,{id:"email",name:"Email",type:"email",class:f(["form-control",{"is-invalid":t.Email}]),rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=o=>l.form.user.email=o),placeholder:"請輸入 Email"},null,8,["modelValue","class"]),n(u,{name:"Email",class:"invalid-feedback"})]),e("div",$,[ee,n(c,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":t.姓名}]),rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[2]||(s[2]=o=>l.form.user.name=o),placeholder:"請輸入姓名"},null,8,["modelValue","class"]),n(u,{name:"姓名",class:"invalid-feedback"})]),e("div",se,[te,n(c,{id:"tel",name:"電話",type:"tel",class:f(["form-control",{"is-invalid":t.電話}]),rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":s[3]||(s[3]=o=>l.form.user.tel=o),placeholder:"請輸入電話"},null,8,["modelValue","class"]),n(u,{name:"電話",class:"invalid-feedback"})]),e("div",ae,[oe,n(c,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":t.地址}]),rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=o=>l.form.user.address=o),placeholder:"請輸入地址"},null,8,["modelValue","class"]),n(u,{name:"地址",class:"invalid-feedback"})]),e("div",le,[ne,U(e("textarea",{name:"",id:"message",class:"form-control","onUpdate:modelValue":s[5]||(s[5]=o=>l.form.message=o),cols:"30",rows:"10"},null,512),[[I,l.form.message]])]),e("div",re,[e("button",{type:"submit",class:"btn btn-danger",disabled:a.cartCount===0},"送出訂單",8,ie)])]),_:1},8,["onSubmit"])])],64)}const pe=k(D,[["render",de]]);export{pe as default};
