import{e as f,m as _,f as u,_ as b,o as r,c as a,a as t,t as s,g as l,F as p,h as $,b as k,r as C,i as M,d as S}from"./index-q-bRCVky.js";import{a as T}from"./sweetalert2.all-sDImy6Vf.js";import{c as h}from"./cartStore-s6rEMNZj.js";import{M as q}from"./bootstrap.esm-TTjMTX3M.js";var w={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"ming777",BASE_URL:"/2023-vue-week06/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:x,VITE_PATH:V}=w,m=f("productsStore",{state:()=>({products:[],currentProduct:{}}),actions:{getAllProduct(){T.get(`${x}/api/${V}/products`).then(o=>{this.products=o.data.products}).catch(o=>{console.log(o)})},getCurrentProduct(o){this.currentProduct=o}}}),E={data(){return{modal:null,qty:1}},methods:{..._(h,["addToCart"]),addQty(){this.qty<20&&(this.qty+=1)},subQty(){this.qty>1&&(this.qty-=1)}},watch:{currentProduct(){this.qty=1}},mounted(){this.modal=new q(this.$refs.modal,{keyboard:!1,backdrop:"static"}),this.$emit("productInstance",this.modal)},computed:{...u(m,["currentProduct"]),...u(h,["carts"])}},A={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"ModalLabel","aria-hidden":"true",ref:"modal"},I={class:"modal-dialog modal-xl",role:"document"},L={class:"modal-content border-0"},U={class:"modal-header bg-dark text-white"},R={class:"modal-title",id:"ModalLabel"},B=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),D={class:"modal-body"},N={class:"row"},Q={class:"col-sm-6"},F=["src"],H={class:"col-sm-6"},O={class:"badge bg-primary rounded-pill"},z={class:"h6"},j={class:"h5"},G={class:"input-group w-50 my-4"},J=["disabled"],K=["value"],W=["disabled"];function X(o,n,g,y,i,d){return r(),a("div",A,[t("div",I,[t("div",L,[t("div",U,[t("h5",R,[t("span",null,s(this.currentProduct.title),1)]),B]),t("div",D,[t("div",N,[t("div",Q,[t("img",{class:"img-fluid",src:this.currentProduct.imageUrl,alt:""},null,8,F)]),t("div",H,[t("span",O,s(this.currentProduct.category),1),t("p",null,"商品描述："+s(this.currentProduct.content),1),t("p",null,"商品內容："+s(this.currentProduct.description),1),t("del",z,"原價 "+s(this.currentProduct.origin_price)+" 元",1),t("div",j,"現在只要 "+s(this.currentProduct.price)+" 元",1),t("div",null,[t("div",G,[t("button",{type:"button",class:"btn btn-secondary",onClick:n[0]||(n[0]=l(c=>d.subQty(),["prevent"])),disabled:i.qty===1}," - ",8,J),t("input",{type:"number",class:"form-control",min:"1",value:i.qty,readonly:""},null,8,K),t("button",{type:"button",class:"btn btn-secondary",onClick:n[1]||(n[1]=l(c=>d.addQty(),["prevent"])),disabled:i.qty===20}," + ",8,W)]),t("button",{type:"button",class:"btn btn-primary",onClick:n[2]||(n[2]=l(c=>o.addToCart(this.currentProduct.id,this.modal,this.qty),["prevent"]))}," 加入購物車 ")])])])])])])],512)}const Y=b(E,[["render",X]]),Z={data(){return{modal:null}},methods:{..._(m,["getAllProduct","getCurrentProduct"]),..._(h,["addToCart"]),getProductModal(o){this.modal=o},openModal(o){this.getCurrentProduct(o),this.modal.show()}},mounted(){this.getAllProduct()},computed:{...u(m,["products","currentProduct"]),...u(h,["carts","loadingStatus"])},components:{ProductModal:Y}},tt={class:"table align-middle"},ot=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),st={style:{width:"200px"}},et=["src"],nt={class:"h6"},dt={class:"h5"},rt={class:"btn-group btn-group-sm"},at=["onClick"],lt=["disabled","onClick"],it={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"};function ct(o,n,g,y,i,d){const c=C("ProductModal");return r(),a(p,null,[t("table",tt,[ot,(r(!0),a(p,null,$(o.products,(e,v)=>(r(),a("tbody",{key:v},[t("tr",null,[t("td",st,[t("img",{style:{height:"200px","background-size":"cover","background-position":"center"},src:e.imageUrl},null,8,et)]),t("td",null,s(e.title),1),t("td",null,[t("del",nt,"原價 "+s(e.origin_price)+" 元",1),t("div",dt,"現在只要 "+s(e.price)+" 元",1)]),t("td",null,[t("div",rt,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:l(P=>d.openModal(e),["prevent"])}," 查看更多 ",8,at),t("button",{type:"button",class:"btn btn-outline-danger",disabled:e.id===this.loadingStatus,onClick:l(P=>o.addToCart(e.id),["prevent"])},[e.id===this.loadingStatus?(r(),a("span",it)):M("",!0),S(" 加到購物車 ")],8,lt)])])])]))),128))]),k(c,{onProductInstance:d.getProductModal},null,8,["onProductInstance"])],64)}const pt=b(Z,[["render",ct]]);export{pt as default};
