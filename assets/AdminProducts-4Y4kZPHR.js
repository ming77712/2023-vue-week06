import{a as b,S as p}from"./sweetalert2.all-sDImy6Vf.js";import{M as k}from"./bootstrap.esm-TTjMTX3M.js";import{_ as P,o as d,c as r,a as e,j as c,v as m,i as w,l as C,F as f,h as E,d as V,t as _,n as y,g as I,b as v,r as U}from"./index-q-bRCVky.js";var D={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"ming777",BASE_URL:"/2023-vue-week06/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:S,VITE_PATH:T}=D,R={props:["currentProduct","isNew"],data(){return{productModal:null,tempProduct:{imagesUrl:[]},sweetMessage:{icon:"",title:"",showConfirmButton:!1,timer:1500}}},methods:{addProduct(){this.tempProduct.imagesUrl.length===0&&this.tempProduct.imagesUrl.push(""),b.post(`${S}/api/${T}/admin/product`,{data:this.tempProduct}).then(t=>{this.setSweetMessageSuccess(t.data.message),p.fire(this.sweetMessage),setTimeout(()=>{this.productModal.hide(),this.$emit("refreshProducts")},1500)}).catch(t=>{this.setSweetMessageError(t.data.message),p.fire(this.sweetMessage)})},editProduct(){this.tempProduct.imagesUrl.length===0&&this.tempProduct.imagesUrl.push(""),b.put(`${S}/api/${T}/admin/product/${this.tempProduct.id}`,{data:this.tempProduct}).then(t=>{this.setSweetMessageSuccess(t.data.message),p.fire(this.sweetMessage),setTimeout(()=>{this.productModal.hide(),this.$emit("refreshProducts")},1500)}).catch(t=>{this.setSweetMessageError(t.data.message),p.fire(this.sweetMessage)})},setSweetMessageSuccess(t){this.sweetMessage.icon="success",this.sweetMessage.title=t,this.sweetMessage.timer=1500},setSweetMessageError(t){this.sweetMessage.icon="error",this.sweetMessage.title=t,this.sweetMessage.timer=2500}},watch:{currentProduct(){this.tempProduct=this.currentProduct}},mounted(){this.productModal=new k(this.$refs.productModal,{keyboard:!1,backdrop:"static"}),this.$emit("productInstance",this.productModal),this.tempProduct=this.currentProduct}},A={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},L={class:"modal-dialog modal-xl"},B={class:"modal-content border-0"},H={class:"modal-header bg-dark text-white"},N={id:"productModalLabel",class:"modal-title"},O={key:0},F={key:1},j=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),z={class:"modal-body"},q={class:"row mb-4"},G={class:"col-sm-4"},J={class:"mb-2"},K={class:"mb-3"},Q=e("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),W=["src"],X={class:"col-sm-8"},Y={class:"mb-3"},Z=e("label",{for:"title",class:"form-label"},"標題",-1),ee={class:"row"},te={class:"mb-3 col-md-6"},se=e("label",{for:"category",class:"form-label"},"分類",-1),oe={class:"mb-3 col-md-6"},le=e("label",{for:"price",class:"form-label"},"單位",-1),ae={class:"row"},de={class:"mb-3 col-md-6"},re=e("label",{for:"origin_price",class:"form-label"},"原價",-1),ie={class:"mb-3 col-md-6"},ne=e("label",{for:"price",class:"form-label"},"售價",-1),ce=e("hr",null,null,-1),ue={class:"mb-3"},me=e("label",{for:"description",class:"form-label"},"產品描述",-1),pe={class:"mb-3"},he=e("label",{for:"content",class:"form-label"},"說明內容",-1),_e={class:"mb-3"},ge={class:"form-check"},be=e("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),fe=e("h4",{class:"mb-2"},"多圖新增",-1),Pe={class:"row mb-2"},Me={class:"mb-3"},we=["for"],ve=["id","onUpdate:modelValue"],Ue=["src"],ye={class:"modal-footer"},Ie=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ke(t,s,i,g,o,a){return d(),r("div",A,[e("div",L,[e("div",B,[e("div",H,[e("h5",N,[i.isNew?(d(),r("span",O,"新增產品")):(d(),r("span",F,"編輯產品"))]),j]),e("div",z,[e("div",q,[e("div",G,[e("div",J,[e("div",K,[Q,c(e("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":s[0]||(s[0]=l=>o.tempProduct.imageUrl=l)},null,512),[[m,o.tempProduct.imageUrl]])]),o.tempProduct.imageUrl?(d(),r("img",{key:0,class:"img-fluid",src:o.tempProduct.imageUrl,alt:"主圖"},null,8,W)):w("",!0)])]),e("div",X,[e("div",Y,[Z,c(e("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":s[1]||(s[1]=l=>o.tempProduct.title=l)},null,512),[[m,o.tempProduct.title]])]),e("div",ee,[e("div",te,[se,c(e("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":s[2]||(s[2]=l=>o.tempProduct.category=l)},null,512),[[m,o.tempProduct.category]])]),e("div",oe,[le,c(e("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":s[3]||(s[3]=l=>o.tempProduct.unit=l)},null,512),[[m,o.tempProduct.unit]])])]),e("div",ae,[e("div",de,[re,c(e("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":s[4]||(s[4]=l=>o.tempProduct.origin_price=l)},null,512),[[m,o.tempProduct.origin_price,void 0,{number:!0}]])]),e("div",ie,[ne,c(e("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":s[5]||(s[5]=l=>o.tempProduct.price=l)},null,512),[[m,o.tempProduct.price,void 0,{number:!0}]])])]),ce,e("div",ue,[me,c(e("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":s[6]||(s[6]=l=>o.tempProduct.description=l)},`
                `,512),[[m,o.tempProduct.description]])]),e("div",pe,[he,c(e("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":s[7]||(s[7]=l=>o.tempProduct.content=l)},`
                `,512),[[m,o.tempProduct.content]])]),e("div",_e,[e("div",ge,[c(e("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":s[8]||(s[8]=l=>o.tempProduct.is_enabled=l)},null,512),[[C,o.tempProduct.is_enabled]]),be])])])]),fe,o.tempProduct.imagesUrl?(d(),r(f,{key:0},[e("div",Pe,[(d(!0),r(f,null,E(o.tempProduct.imagesUrl,(l,u)=>(d(),r("div",{class:"col-6 mb-1",key:u},[e("div",Me,[e("label",{for:"images"+u,class:"form-label"},"圖片網址",8,we),c(e("input",{id:"images"+u,"onUpdate:modelValue":M=>o.tempProduct.imagesUrl[u]=M,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,ve),[[m,o.tempProduct.imagesUrl[u]]])]),e("img",{class:"images",src:l},null,8,Ue)]))),128))]),!o.tempProduct.imagesUrl.length||o.tempProduct.imagesUrl.length<5?(d(),r("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100 mb-3",onClick:s[9]||(s[9]=l=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")):w("",!0),o.tempProduct.imagesUrl.length?(d(),r("button",{key:1,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:s[10]||(s[10]=l=>o.tempProduct.imagesUrl.pop())}," 刪除圖片 ")):w("",!0)],64)):w("",!0)]),e("div",ye,[Ie,i.isNew?(d(),r("button",{key:0,type:"button",class:"btn btn-primary",onClick:s[11]||(s[11]=(...l)=>a.addProduct&&a.addProduct(...l))}," 確認 ")):(d(),r("button",{key:1,type:"button",class:"btn btn-primary",onClick:s[12]||(s[12]=(...l)=>a.editProduct&&a.editProduct(...l))}," 確認 "))])])])],512)}const Ee=P(R,[["render",ke]]);var Ve={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"ming777",BASE_URL:"/2023-vue-week06/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Se,VITE_PATH:Te}=Ve,xe={props:["currentProduct"],data(){return{delProductModal:null,sweetMessage:{icon:"",title:"",showConfirmButton:!1,timer:1500}}},methods:{delProduct(){b.delete(`${Se}/api/${Te}/admin/product/${this.currentProduct.id}`).then(t=>{this.setSweetMessageSuccess(t.data.message),p.fire(this.sweetMessage),setTimeout(()=>{this.delProductModal.hide(),this.$emit("refreshProducts")},1500)}).catch(t=>{this.setSweetMessageError(t.data.message),p.fire(this.sweetMessage)})},setSweetMessageSuccess(t){this.sweetMessage.icon="success",this.sweetMessage.title=t,this.sweetMessage.timer=1500},setSweetMessageError(t){this.sweetMessage.icon="error",this.sweetMessage.title=t,this.sweetMessage.timer=2500}},mounted(){this.delProductModal=new k(this.$refs.delProductModal,{keyboard:!1,backdrop:"static"}),this.$emit("productDeleteInstance",this.delProductModal)}},$e={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Ce={class:"modal-dialog"},De={class:"modal-content border-0"},Re=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除產品")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ae={class:"modal-body"},Le={class:"text-danger"},Be={class:"modal-footer"},He=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ne(t,s,i,g,o,a){return d(),r("div",$e,[e("div",Ce,[e("div",De,[Re,e("div",Ae,[V(" 是否刪除 "),e("strong",Le,_(i.currentProduct.title),1),V(" 商品(刪除後將無法恢復)。 ")]),e("div",Be,[He,e("button",{type:"button",class:"btn btn-danger",onClick:s[0]||(s[0]=(...l)=>a.delProduct&&a.delProduct(...l))}," 確認刪除 ")])])])],512)}const Oe=P(xe,[["render",Ne]]),Fe={props:["pages"],methods:{changePage(t){this.$emit("change-page",t)}}},je={"aria-label":"Page navigation"},ze={class:"pagination"},qe=e("span",{"aria-hidden":"true"},"«",-1),Ge=[qe],Je=["onClick"],Ke=e("span",{"aria-hidden":"true"},"»",-1),Qe=[Ke];function We(t,s,i,g,o,a){return d(),r("nav",je,[e("ul",ze,[e("li",{class:y(["page-item",{disabled:i.pages.current_page===1}])},[e("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:s[0]||(s[0]=I(l=>a.changePage(i.pages.current_page-1),["prevent"]))},Ge)],2),(d(!0),r(f,null,E(i.pages.total_pages,(l,u)=>(d(),r("li",{key:u,class:y(["page-item",{active:l===i.pages.current_page}])},[e("a",{class:"page-link",href:"#",onClick:I(M=>a.changePage(l),["prevent"])},_(l),9,Je)],2))),128)),e("li",{class:y(["page-item",{disabled:i.pages.current_page===i.pages.total_pages}])},[e("a",{class:"page-link",href:"#","aria-label":"Next",onClick:s[1]||(s[1]=I(l=>a.changePage(i.pages.current_page+1),["prevent"]))},Qe)],2)])])}const Xe=P(Fe,[["render",We]]);var Ye={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"ming777",BASE_URL:"/2023-vue-week06/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Ze,VITE_PATH:et}=Ye,tt={data(){return{uploadImgModal:null,formData:null,imageUrl:"",sweetMessage:{icon:"",title:"",showConfirmButton:!1,timer:1500}}},methods:{uploadImg(){typeof this.formData=="object"&&b.post(`${Ze}/api/${et}/admin/upload`,this.formData).then(t=>{this.imageUrl=t.data.imageUrl,this.setSweetMessageSuccess("圖片新增成功"),p.fire(this.sweetMessage)}).catch(t=>{this.setSweetMessageError(t.message),p.fire(this.sweetMessage)})},handleUploadImg(t){this.formData=new FormData,this.formData.append("file-to-upload",t.target.files[0])},setSweetMessageSuccess(t){this.sweetMessage.icon="success",this.sweetMessage.title=t,this.sweetMessage.timer=1500},setSweetMessageError(t){this.sweetMessage.icon="error",this.sweetMessage.title=t,this.sweetMessage.timer=2500}},mounted(){this.uploadImgModal=new k(this.$refs.uploadImgModal,{keyboard:!1,backdrop:"static"}),this.$emit("UploadImgInstance",this.uploadImgModal)}},st={id:"uploadImgModal",ref:"uploadImgModal",class:"modal fade",tabindex:"-1","aria-labelledby":"uploadImgModalLabel","aria-hidden":"true"},ot={class:"modal-dialog"},lt={class:"modal-content border-0"},at=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"上傳圖片")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),dt={class:"modal-body"},rt={class:"mb-2"},it=["src"],nt={class:"mb-2"},ct=e("label",{for:"imgUrl",class:"form-label"},"圖片位址",-1),ut=["value"],mt={class:"modal-footer"},pt=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ht(t,s,i,g,o,a){return d(),r("div",st,[e("div",ot,[e("div",lt,[at,e("div",dt,[e("form",rt,[e("input",{type:"file",name:"file-to-upload",onChange:s[0]||(s[0]=(...l)=>a.handleUploadImg&&a.handleUploadImg(...l))},null,32)]),e("div",null,[e("img",{class:"mb-2",src:o.imageUrl},null,8,it),e("div",nt,[ct,e("input",{id:"imgUrl",type:"text",class:"form-control",value:o.imageUrl},null,8,ut)])])]),e("div",mt,[pt,e("button",{type:"button",class:"btn btn-primary",onClick:s[1]||(s[1]=(...l)=>a.uploadImg&&a.uploadImg(...l))}," 上傳 ")])])])],512)}const _t=P(tt,[["render",ht]]);var gt={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"ming777",BASE_URL:"/2023-vue-week06/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:bt,VITE_PATH:ft}=gt,h={icon:"",title:"",showConfirmButton:!1,timer:1500},Pt={data(){return{productModal:null,delProductModal:null,uploadImgModal:null,currentProduct:{imagesUrl:[]},products:[],pagination:{},isNew:!1}},methods:{getAllProduct(t=1){b.get(`${bt}/api/${ft}/admin/products?page=${t}`).then(s=>{const{products:i,pagination:g}=s.data;this.products=i,this.pagination=g}).catch(s=>{this.setSweetMessageError(s.data.message),p.fire(h)})},getProductModal(t){this.productModal=t},getProductDeleteModal(t){this.delProductModal=t},getUploadImgModal(t){this.uploadImgModal=t},refreshProducts(){this.getAllProduct()},openModal(t,s){t==="productModal"?(this.currentProduct={imagesUrl:[]},this.isNew=!0,this.productModal.show()):t==="editModal"?(this.currentProduct={...s},this.isNew=!1,this.productModal.show()):t==="delProductModal"?(this.currentProduct=s,this.delProductModal.show()):t==="uploadImgModal"&&this.uploadImgModal.show()},setSweetMessageSuccess(t){h.icon="success",h.title=t,h.timer=1500},setSweetMessageError(t){h.icon="error",h.title=t,h.timer=2500}},mounted(){this.getAllProduct()},components:{ProductAdminModal:Ee,ProductDeleteModal:Oe,Pagination:Xe,UploadImgModal:_t}},Mt={class:"container"},wt={class:"text-end mt-4"},vt={class:"table mt-4"},Ut=e("thead",null,[e("tr",null,[e("th",{width:"120"},"分類"),e("th",null,"產品名稱"),e("th",{width:"120"},"原價"),e("th",{width:"120"},"售價"),e("th",{width:"100"},"是否啟用"),e("th",{width:"120"},"編輯")])],-1),yt={class:"btn-group"},It=["onClick"],kt=["onClick"];function Et(t,s,i,g,o,a){const l=U("pagination"),u=U("Product-Admin-Modal"),M=U("Product-Delete-Modal"),x=U("Upload-Img-Modal");return d(),r(f,null,[e("div",Mt,[e("div",wt,[e("button",{onClick:s[0]||(s[0]=n=>a.openModal("uploadImgModal")),class:"btn btn-primary me-2"}," 上傳圖片 "),e("button",{onClick:s[1]||(s[1]=n=>a.openModal("productModal")),class:"btn btn-primary"}," 建立新的產品 ")]),e("table",vt,[Ut,e("tbody",null,[(d(!0),r(f,null,E(o.products,n=>(d(),r("tr",{key:n.id},[e("td",null,_(n.category),1),e("td",null,_(n.title),1),e("td",null,_(n.origin_price),1),e("td",null,_(n.price),1),e("td",null,[e("span",{class:y(n.is_enabled?"text-success":"text-danger")},_(n.is_enabled?"啟用":"未啟用"),3)]),e("td",null,[e("div",yt,[e("button",{onClick:$=>a.openModal("editModal",n),type:"button",class:"btn btn-outline-primary btn-sm"}," 編輯 ",8,It),e("button",{onClick:$=>a.openModal("delProductModal",n),type:"button",class:"btn btn-outline-danger btn-sm"}," 刪除 ",8,kt)])])]))),128))])]),v(l,{pages:o.pagination,onChangePage:a.getAllProduct},null,8,["pages","onChangePage"])]),v(u,{"current-product":o.currentProduct,"is-new":o.isNew,onProductInstance:a.getProductModal,onRefreshProducts:a.refreshProducts},null,8,["current-product","is-new","onProductInstance","onRefreshProducts"]),v(M,{"current-product":o.currentProduct,onProductDeleteInstance:a.getProductDeleteModal,onRefreshProducts:a.refreshProducts},null,8,["current-product","onProductDeleteInstance","onRefreshProducts"]),v(x,{onUploadImgInstance:a.getUploadImgModal},null,8,["onUploadImgInstance"])],64)}const xt=P(Pt,[["render",Et]]);export{xt as default};
